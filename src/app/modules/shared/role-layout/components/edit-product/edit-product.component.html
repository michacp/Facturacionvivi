<div class="container py-3">
  <h2 class="text-center mb-4 titulo-producto">Editar Producto</h2>

  <form [formGroup]="productoForm" (ngSubmit)="onSubmit()" class="row g-3 justify-content-center">

    <!-- Nombre -->
    <div class="col-12">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Nombre</mat-label>
        <input matInput formControlName="nombre" placeholder="Ingrese el nombre del producto" />
      </mat-form-field>
    </div>

    <!-- Descripción -->
    <div class="col-12">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Descripción</mat-label>
        <textarea matInput formControlName="descripcion" placeholder="Ingrese una descripción del producto" rows="3">
        </textarea>
      </mat-form-field>
    </div>

    <!-- Tipo de Ítem -->
 

    <!-- Precio Unitario -->
    <div class="col-md-6 col-lg-4">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Precio Unitario</mat-label>
        <input matInput type="number" formControlName="precio_unitario" placeholder="Ej: 10.00" />
      </mat-form-field>
    </div>

    <!-- Stock -->


    <!-- Impuesto -->
    <div class="col-md-6 col-lg-4">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Impuesto</mat-label>
        <mat-select [formControl]="impuestoControl" (selectionChange)="onImpuestoSeleccionado($event.value)">
          <mat-option [value]="null">Seleccione...</mat-option>
          <mat-option *ngFor="let imp of impuestos" [value]="imp.id">
            {{ imp.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Valor de Impuesto -->
    <div class="col-md-6 col-lg-4">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Valor de Impuesto</mat-label>
        <mat-select formControlName="id_tarifa_impuesto">
          <mat-option [value]="null">Seleccione...</mat-option>
          <mat-option *ngFor="let item of porcentajes" [value]="item.id">
            {{ item.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Selector de Marca -->
    <div class="col-12 col-lg-6">
      <app-generic-selector *ngIf="showComponents" label="Marca" placeholder="Buscar Marca" [options]="marcas"
        (optionSelected)="buscarmodelos($event)">
      </app-generic-selector>
    </div>

    <!-- Selector de Modelos -->
    <div class="col-12">
      <app-generic-chips-selector *ngIf="showComponents" [availableItems]="modelos"
        [preselectedItems]="preselectedModels" label="Modelos" (selectionChange)="updateSelectedModels($event)">
      </app-generic-chips-selector>
    </div>
    <div class="col-12 mt-4">
      <h4>Lotes</h4>

      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>Lote</th>
            <th>Cantidad</th>
            <th>Fecha Ingreso</th>
          </tr>
        </thead>
        <tbody formArrayName="lotes">
          <tr *ngFor="let lote of lotesForm.controls; let i = index" [formGroupName]="i">

            <td>
              <input matInput type="text" class="form-control" formControlName="numero_lote" readonly />
            </td>

            <td>
              <input matInput type="number" class="form-control" formControlName="cantidad" />
            </td>

            <td>
              <input matInput type="text" class="form-control" formControlName="fecha_ingreso" readonly />
            </td>

          </tr>
        </tbody>
      </table>
    </div>
    <!-- Botones -->
    <div class="col-12 text-center mt-4">
      <button mat-raised-button color="primary" type="submit" [disabled]="productoForm.invalid">
        Actualizar Producto
      </button>
      <button mat-stroked-button color="warn" type="button" class="ms-2" (click)="cerrar()">
        Cancelar
      </button>
    </div>

  </form>
</div>